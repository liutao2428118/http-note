# 重定向与负载均衡

## 为什么要重定向

1. 可靠的执行 HTTP 事务
2. 最小化延时
3. 节约网络带宽

Web 内容可以分布在很多地方。基于可靠性考虑，这里出现了问题，可以重定向到其他地方。客户端也能访问就近的资源。

## 重定向带何地

从重定向到目标的角度来看，可以是 服务器、代理、缓存、网关。对于客户端来说这些都是服务器。重定向到离客户端最近的代理来减轻网络带宽的压力。缩小延迟！

## 重定向协议概述

![Image text](/images/1648521474(1).png)

![Image text](/images/1648521523(1).png)

## 通用的重定向方法

### HTTP 重定向

Web 服务器可以将较小的重定向报文发回给客户端，告诉告诉客户端可以去其他地方试试。

![Image text](/images/1648521847(1).png)

HTTP 重定向的一些缺点：

1. 需要原始服务器进行大量处理来判断艺重定向到哪台服务器。
2. 增加了用户时延，因为访问页面时要进行两次往返。
3. 如果重定向服务器出故障，站点就会瘫痪。

### DNS 重定向

DNS 服务器单一域名可以配置多个 IP 地址，客户端访问一台服务器时，必须先解析域名找到对应的服务器 IP 地址，通过 IP 地址请求服务器资源。DNS 服务器 通过重定向技术，也称DNS 轮转，每次有不同的客户端请求进来了，轮转来返回 IP 地址。也可以达到负载均衡的效果。

![Image text](/images/1648522464(1).png)

DNS 重定向带来的问题：

DNS 缓存带来的影响，DNS 对服务器的每次查询都会得到不同服务器地址序列，所以 DNS 地址轮转会将负载均衡。但是这种负载均衡并不完美，因为 DNS 查询的结果可能会被缓存起来，并被其他各种应用程序使用。

### 任播寻址

任播（英语：anycast）是一种网络定址和路由的策略，使得数据可以根据路由拓扑来决定送到“最近”或“最好”的目的地。

任播是与单播（unicast）、广播（broadcast）和多播（multicast）不同的方式。

1. 在单播中，在网络地址和网络节点之间存在一一对应的关系。
2. 在广播和多播中，在网络地址和网络节点之间存在一对多的关系：每一个发送地址对应一群接收可以复制信息的节点。
3. 在任播中，在网络地址和网络节点之间存在一对多的关系：每一个地址对应一群接收节点，但在任何给定时间，只有其中之一可以接收到发送端来的信息

![Image text](/images/1648522872(1).png)

### IP MAC 转发

![Image text](/images/1648523191(1).png)

### IP 地址转发

NAT 网络地址转换。

## 代理的重定向方法

1. 显示浏览器配置
2. 代理自动配置
3. Web 代理自动发现协议

## 缓存重定向方法

略...